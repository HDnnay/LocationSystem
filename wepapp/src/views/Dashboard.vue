<template>
    <div class="dashboard">
        <!-- ä»ªè¡¨ç›˜å¤´éƒ¨åŒºåŸŸ -->
        <div class="dashboard-header gradient-bg">
            <div class="header-content">
                <div class="welcome-section">
                    <span class="welcome-icon">ğŸ˜Š</span>
                    <h2 class="welcome-title">ä»ªè¡¨ç›˜</h2>
                    <p class="welcome-text">æ¬¢è¿å›æ¥, admin! ä»Šå¤©æ˜¯{{ currentDate }}</p>
                </div>
                <div class="header-actions">
                    <button class="refresh-btn">
                        <span class="refresh-icon">ğŸ”„</span> åˆ·æ–°æ•°æ®
                    </button>
                    <span class="last-update">æœ€åæ›´æ–°: {{ lastUpdateTime }}</span>
                </div>
            </div>
        </div>

        <!-- ç»Ÿè®¡å¡ç‰‡åŒºåŸŸ -->
        <div class="stats-grid">
            <!-- æ€»ç”¨æˆ·æ•°å¡ç‰‡ -->
            <div class="stat-card user-card">
                <div class="stat-icon user-icon">ğŸ‘¥</div>
                <div class="stat-content">
                    <h3 class="stat-number">16</h3>
                    <p class="stat-label">æ€»ç”¨æˆ·æ•°</p>
                </div>
                <div class="stat-footer">
                    <span class="footer-icon">ğŸ“ˆ</span>
                    <span class="footer-text">æœ¬å‘¨æ–°å¢ 16</span>
                </div>
                <div class="stat-status">
                    <span class="status-item active">
                        <span class="status-dot green"></span>
                        æ´»è·ƒ: 16
                    </span>
                    <span class="status-item inactive">
                        <span class="status-dot gray"></span>
                        ç¦ç”¨: 0
                    </span>
                </div>
            </div>

            <!-- è§’è‰²æ•°é‡å¡ç‰‡ -->
            <div class="stat-card role-card">
                <div class="stat-icon role-icon">ğŸ­</div>
                <div class="stat-content">
                    <h3 class="stat-number">3</h3>
                    <p class="stat-label">è§’è‰²æ•°é‡</p>
                </div>
                <div class="stat-footer">
                    <span class="footer-icon">ğŸ¯</span>
                    <span class="footer-text">æ´»è·ƒè§’è‰² 3</span>
                </div>
                <div class="stat-status">
                    <span class="status-item">
                        <span class="status-text">è§’è‰²ç»“æ„å‡è¡¡ï¼Œæƒé™é…ç½®åˆç†</span>
                    </span>
                </div>
            </div>

            <!-- æƒé™æ•°é‡å¡ç‰‡ -->
            <div class="stat-card permission-card">
                <div class="stat-icon permission-icon">ğŸ”‘</div>
                <div class="stat-content">
                    <h3 class="stat-number">36</h3>
                    <p class="stat-label">æƒé™æ•°é‡</p>
                </div>
                <div class="stat-footer">
                    <span class="footer-icon">ğŸ“‹</span>
                    <span class="footer-text">ç›®å½•: 3 | é¡µé¢: 15</span>
                </div>
                <div class="stat-status">
                    <span class="status-item">
                        <span class="status-text">æƒé™ä½“ç³»å®Œæ•´ï¼Œå±‚çº§æ¸…æ™°</span>
                    </span>
                </div>
            </div>

            <!-- éƒ¨é—¨æ•°é‡å¡ç‰‡ -->
            <div class="stat-card dept-card">
                <div class="stat-icon dept-icon">ğŸ¢</div>
                <div class="stat-content">
                    <h3 class="stat-number">24</h3>
                    <p class="stat-label">éƒ¨é—¨æ•°é‡</p>
                </div>
                <div class="stat-footer">
                    <span class="footer-icon">ğŸ‘¥</span>
                    <span class="footer-text">æœ‰ç”¨ç”¨æˆ· 7</span>
                </div>
                <div class="stat-status">
                    <span class="status-item">
                        <span class="status-text">ç»„ç»‡ç»“æ„æ˜ç¡®ï¼Œäººå‘˜åˆ†å¸ƒåˆç†</span>
                    </span>
                </div>
            </div>
        </div>

        <!-- ç”¨æˆ·æ´»åŠ¨è¶‹åŠ¿å›¾è¡¨ -->
        <div class="activity-chart card">
            <div class="chart-header">
                <h3 class="section-title">ç”¨æˆ·æ´»åŠ¨è¶‹åŠ¿ (æœ€è¿‘7å¤©)</h3>
                <div class="chart-actions">
                    <button class="chart-action-btn active">æ—¥</button>
                    <button class="chart-action-btn">å‘¨</button>
                    <button class="chart-action-btn">æœˆ</button>
                </div>
            </div>
            <div class="chart-container">
                <!-- ç®€å•çš„æ¨¡æ‹ŸæŠ˜çº¿å›¾ -->
                <div class="chart-simulation">
                    <div class="chart-grid">
                        <div class="grid-line" v-for="i in 5" :key="i"></div>
                    </div>
                    <div class="chart-line-container">
                        <!-- ä½¿ç”¨SVGè·¯å¾„å®ç°çš„è¶‹åŠ¿çº¿ -->
                        <svg class="chart-svg" viewBox="0 0 400 200" preserveAspectRatio="none">
                            <path class="chart-line-path" d="M50,150 Q100,100 150,120 T250,80 T350,100" />
                        </svg>
                        <div class="chart-dots">
                            <div class="chart-dot" v-for="i in 7" :key="i"></div>
                        </div>
                    </div>
                    <div class="chart-labels">
                        <span v-for="(label, index) in chartLabels" :key="index">{{ label }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä»Šæ—¥æ•°æ®éƒ¨åˆ† -->
        <div class="today-data card">
            <div class="today-header">
                <h3 class="section-title">ä»Šæ—¥æ•°æ®</h3>
            </div>
            <div class="today-stats">
                <div class="today-stat-item">
                    <div class="today-stat-label">ä»Šæ—¥ç™»å½•</div>
                    <div class="today-stat-number">12</div>
                </div>
                <div class="today-stat-item">
                    <div class="today-stat-label">æ–°å¢ç”¨æˆ·</div>
                    <div class="today-stat-number">3</div>
                </div>
                <div class="today-stat-item">
                    <div class="today-stat-label">æ´»è·ƒç”¨æˆ·</div>
                    <div class="today-stat-number">8</div>
                </div>
                <div class="today-stat-item">
                    <div class="today-stat-label">ç³»ç»Ÿè®¿é—®</div>
                    <div class="today-stat-number">45</div>
                </div>
            </div>
        </div>
    </div>
</template>

<script>
    export default {
        name: 'Dashboard',
        data() {
            return {
                activities: [
                    { id: 1, content: 'å‘å¸ƒäº†æ–°æ–‡ç« ã€ŠVue3å®æˆ˜æŒ‡å—ã€‹', user: 'ç®¡ç†å‘˜', time: 'ä»Šå¤© 09:23' },
                    { id: 2, content: 'åˆ›å»ºäº†æ–°åˆ†ç±»ã€ŠæŠ€æœ¯åˆ†äº«ã€‹', user: 'ç®¡ç†å‘˜', time: 'æ˜¨å¤© 15:47' },
                    { id: 3, content: 'ç¼–è¾‘äº†æ–‡ç« ã€ŠReactæ€§èƒ½ä¼˜åŒ–ã€‹', user: 'å¼ ä¸‰', time: '2024-01-10 11:30' },
                    { id: 4, content: 'ä¸Šä¼ äº†5å¼ æ–°å›¾ç‰‡', user: 'æå››', time: '2024-01-09 16:15' },
                    { id: 5, content: 'æ·»åŠ äº†æ–°ç”¨æˆ·ç‹äº”', user: 'ç®¡ç†å‘˜', time: '2024-01-08 14:20' }
                ],
                currentDate: '',
                lastUpdateTime: '',
                chartLabels: ['12/03', '12/04', '12/05', '12/06', '12/07', '12/08', '12/09']
            }
        },
        mounted() {
            this.updateDateTime();
            // æ¯ç§’æ›´æ–°ä¸€æ¬¡æ—¶é—´
            this.timer = setInterval(() => {
                this.updateDateTime();
            }, 1000);
        },
        beforeDestroy() {
            clearInterval(this.timer);
        },
        methods: {
            handleLogout() {
                // æ¸…é™¤ç™»å½•çŠ¶æ€
                localStorage.removeItem('isLoggedIn')
                // è·³è½¬åˆ°ç™»å½•é¡µ
                this.$router.push('/login')
            },
            updateDateTime() {
                // è·å–å½“å‰æ—¥æœŸå’Œæ—¶é—´
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                const day = String(now.getDate()).padStart(2, '0');
                const hours = String(now.getHours()).padStart(2, '0');
                const minutes = String(now.getMinutes()).padStart(2, '0');
                const seconds = String(now.getSeconds()).padStart(2, '0');

                // æ ¼å¼åŒ–æ˜ŸæœŸ
                const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
                const weekday = weekdays[now.getDay()];

                this.currentDate = `${year}å¹´${month}æœˆ${day}æ—¥ ${weekday}`;
                this.lastUpdateTime = `${hours}:${minutes}:${seconds}`;
            }
        }
    }
</script>

<style scoped>
    .dashboard {
        padding: 1rem 0;
    }

    /* æ¸å˜èƒŒæ™¯ */
    .gradient-bg {
        background: var(--primary-color);
        color: white;
        border-radius: 8px;
    }

    /* ä»ªè¡¨ç›˜å¤´éƒ¨ */
    .dashboard-header {
        margin-bottom: 1.5rem;
        padding: 1.5rem;
    }

    .header-content {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .welcome-section {
        display: flex;
        flex-direction: column;
        gap: 0.5rem;
    }

    .welcome-icon {
        font-size: 1.5rem;
        margin-right: 0.5rem;
    }

    .welcome-title {
        font-size: 1.8rem;
        margin: 0;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }

    .welcome-text {
        font-size: 1rem;
        margin: 0;
        opacity: 0.9;
    }

    .header-actions {
        display: flex;
        align-items: center;
        gap: 1rem;
        flex-wrap: wrap;
    }

    .refresh-btn {
        background: rgba(255, 255, 255, 0.2);
        color: white;
        border: none;
        padding: 0.5rem 1rem;
        border-radius: 4px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 500;
        transition: background 0.3s;
    }

        .refresh-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

    .last-update {
        font-size: 0.9rem;
        opacity: 0.9;
    }

    /* å“åº”å¼è®¾è®¡ */
    @media (max-width: 768px) {
        .header-content {
            flex-direction: column;
            align-items: flex-start;
        }

        .welcome-title {
            font-size: 1.5rem;
        }
    }

    /* ç»Ÿè®¡å¡ç‰‡ */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: white;
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: transform 0.2s, box-shadow 0.2s;
        border: 1px solid #f0f0f0;
    }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

    /* ä¸åŒç±»å‹å¡ç‰‡çš„é¢œè‰²ä¸»é¢˜ */
    .user-card .stat-icon {
        background: #4285f4;
    }

    .role-card .stat-icon {
        background: #ea4335;
    }

    .permission-card .stat-icon {
        background: #fbbc05;
    }

    .dept-card .stat-icon {
        background: #34a853;
    }

    .stat-icon {
        font-size: 2.5rem;
        width: 60px;
        height: 60px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        border-radius: 8px;
        margin-bottom: 1rem;
    }

    .stat-content {
        margin-bottom: 1rem;
    }

    .stat-number {
        font-size: 2.2rem;
        font-weight: 600;
        color: var(--text-color);
        margin: 0;
        line-height: 1;
    }

    .stat-label {
        color: #666;
        margin: 0.5rem 0 0;
        font-size: 1rem;
    }

    /* å¡ç‰‡åº•éƒ¨ä¿¡æ¯ */
    .stat-footer {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        margin-bottom: 1rem;
        padding-bottom: 1rem;
        border-bottom: 1px dashed #eee;
    }

    .footer-icon {
        font-size: 1rem;
        color: var(--primary-color);
    }

    .footer-text {
        font-size: 0.9rem;
        color: #666;
    }

    /* å¡ç‰‡çŠ¶æ€ä¿¡æ¯ */
    .stat-status {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
    }

    .status-item {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.85rem;
    }

    .status-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
    }

        .status-dot.green {
            background-color: #43e97b;
        }

        .status-dot.gray {
            background-color: #d1d1d1;
        }

    .status-text {
        color: #666;
        font-size: 0.85rem;
    }

    /* ç”¨æˆ·æ´»åŠ¨è¶‹åŠ¿å›¾è¡¨ */
    .activity-chart {
        background: white;
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
    }

    .chart-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1.5rem;
    }

    .chart-actions {
        display: flex;
        gap: 0.5rem;
    }

    .chart-action-btn {
        background: #f5f5f5;
        border: none;
        padding: 0.3rem 0.8rem;
        border-radius: 4px;
        cursor: pointer;
        font-size: 0.9rem;
        color: #666;
        transition: all 0.3s;
    }

        .chart-action-btn.active {
            background: var(--primary-color);
            color: white;
        }

    .chart-container {
        height: 250px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    /* æ¨¡æ‹Ÿå›¾è¡¨æ ·å¼ */
    .chart-simulation {
        width: 100%;
        height: 100%;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .chart-grid {
        position: absolute;
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }

    .grid-line {
        height: 1px;
        background: #eee;
    }

    .chart-line-container {
        position: relative;
        width: 80%;
        height: 80%;
        overflow: visible;
    }

    /* ä½¿ç”¨SVGè·¯å¾„å®ç°æ›´çœŸå®çš„è¶‹åŠ¿çº¿ */
    .chart-svg {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
    }

    .chart-line-path {
        fill: none;
        stroke: var(--primary-color);
        stroke-width: 2px;
        stroke-linecap: round;
    }

    .chart-dots {
        position: absolute;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transform: translateY(0);
        padding: 0 5px;
    }

    .chart-dot {
        width: 8px;
        height: 8px;
        background: var(--primary-color);
        border-radius: 50%;
        border: 2px solid white;
        box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.1);
        margin-top: 30px; /* è°ƒæ•´ç‚¹çš„å‚ç›´ä½ç½® */
    }

    .chart-labels {
        position: absolute;
        bottom: -25px;
        width: 100%;
        display: flex;
        justify-content: space-between;
        color: #666;
        font-size: 0.85rem;
    }

    /* ä»Šæ—¥æ•°æ®éƒ¨åˆ† */
    .today-data {
        background: white;
        border-radius: 8px;
        padding: 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
    }

    .today-header {
        margin-bottom: 1.5rem;
    }

    .today-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 1.5rem;
    }

    .today-stat-item {
        text-align: center;
    }

    .today-stat-label {
        color: #666;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
    }

    .today-stat-number {
        font-size: 2rem;
        font-weight: 600;
        color: var(--primary-color);
        margin: 0;
    }

    /* é€šç”¨æ ‡é¢˜æ ·å¼ */
    .section-title {
        font-size: 1.25rem;
        margin-bottom: 1rem;
        color: var(--text-color);
        font-weight: 600;
    }

    /* ç§»åŠ¨ç«¯å“åº”å¼ */
    @media (max-width: 768px) {
        .stats-grid {
            grid-template-columns: 1fr;
        }

        .today-stats {
            grid-template-columns: repeat(2, 1fr);
        }

        .chart-header {
            flex-direction: column;
            align-items: flex-start;
            gap: 1rem;
        }
    }
</style>